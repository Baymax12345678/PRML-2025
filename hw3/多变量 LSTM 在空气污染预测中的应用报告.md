# 多变量 LSTM 在空气污染预测中的应用报告

<p style="text-align:center; font-weight:bold;">
  郭树立<br>
  22376128
</p>

## 摘要
本文面向北京地区五年（2010 – 2014）逐小时空气质量与气象观测数据，构建多变量长短期记忆网络（Long Short‑Term Memory，LSTM）以预测未来一小时 PM2.5 浓度。相较于传统循环神经网络（RNN），LSTM 通过门控机制与细胞状态有效缓解梯度消失/爆炸问题，并可在多特征场景下对长期依赖进行建模。实验表明，经过系统的数据预处理与动态学习率、早停等策略优化后，所建模型在测试集上取得较低的均方误差（MSE）与平均绝对误差（MAE），能够准确追踪污染水平变化趋势。

---

## 1 引言
空气污染已成为威胁城市公共健康的关键因素。提前数小时给出可靠的 PM2.5 预报，可为公共管理与个人防护提供决策依据。由于污染演化受温度、湿度、风向等多重气象变量影响，传统单变量模型往往无法捕捉复杂的跨变量依赖；而 LSTM 在时间序列建模方面表现出色，被广泛用于金融行情、语音和气象预测等领域。基于此，本文采用多变量 LSTM，对历史 10 小时的气象与污染记录进行联合学习，预测下一小时的细颗粒物浓度。

---

## 2 理论背景

### 2.1 RNN 的梯度困境  
普通 RNN 通过链式梯度传播易产生梯度消失或爆炸现象，导致模型在长序列学习中难以捕捉早期信息。这限制了它在空气污染等具有长期依赖特征的任务上的应用。

### 2.2 LSTM 结构与信息流  
LSTM 在每个时间步 $t$ 接收当前输入向量 $x_t$、上一时刻隐藏状态 $h_{t-1}$ 与细胞状态 $C_{t-1}$。通过三个门控单元调控信息流：

$$
\begin{aligned}
f_t &= \sigma(W_f x_t + U_f h_{t-1} + b_f)\quad&\text{(遗忘门)}\\
i_t &= \sigma(W_i x_t + U_i h_{t-1} + b_i)\quad&\text{(输入门)}\\
\tilde{C}_t &= \tanh(W_c x_t + U_c h_{t-1} + b_c)\quad&\text{(候选状态)}\\
C_t &= f_t \odot C_{t-1} + i_t \odot \tilde{C}_t\quad&\text{(细胞状态更新)}\\
o_t &= \sigma(W_o x_t + U_o h_{t-1} + b_o)\quad&\text{(输出门)}\\
h_t &= o_t \odot \tanh(C_t)\quad&\text{(隐藏状态)}
\end{aligned}
$$


门控向量 $f_t,i_t,o_t\in[0,1]$ 通过 Sigmoid 激活函数自适应调节信息的保留与抑制，从而在反向传播中形成“线性传送带”，显著缓解梯度衰减。

<img src="https://raw.githubusercontent.com/Baymax12345678/img_repo/master/img/image-20250507175430511.png" alt="image-20250507175430511" style="zoom:50%;" />

### 2.3 多变量 LSTM  
当每个时间步包含多重特征（气温、气压、风速等）时，可将它们拼接为向量 $x_t$，整体输入给 LSTM。与单变量模型相比，多变量模型能显式学习变量间的交互关系，从而在污染预测等复杂场景中获得更好的泛化能力作业3报告。

### 2.4 优化与正则化策略  
- **动态学习率**：若验证损失在连续四次迭代无明显下降，则将学习率缩减一半，使参数在最优解附近更平稳地收敛。
- **早停法**：若验证损失在若干轮内无改善，即停止训练，防止过拟合。  
- **批归一化 / Dropout**：进一步提升网络稳定性与鲁棒性。

---

## 3 数据集与预处理

### 3.1 数据来源与特征  
数据来自 Kaggle“Beijing PM2.5 Data Set”，涵盖 2010–2014 年美国驻北京大使馆监测站逐小时记录，含八个变量：PM2.5、露点、温度、气压、风向、平均风速、小时雨量与小时雪量。根据课题要求，将过去 10 小时观测作为输入，预测下一小时 PM2.5。

### 3.2 清洗与变换  
1. **类别映射**：将风向字符串映射为数值标签，使网络可读取。  
2. **滑动窗口**：构造样本张量大小为 $(43790,10,8)$，对应标签张量 $(43790,1)$。  
3. **归一化**：对所有特征按列与标签按单列分别进行 Min‑Max 归一化，加速收敛并避免量纲差异。  

---

## 4 实验设置

| 要素          | 配置                            |
| ------------- | ------------------------------- |
| LSTM 隐单元数 | 64                              |
| 网络深度      | 2 个 LSTM 层 + 1 个全连接输出层 |
| 损失函数      | MSE（均方误差）                 |
| 优化器        | Adam，初始学习率 0.001          |
| 批大小        | 64                              |
| 训练轮次      | 设定上限 50，配合早停自动截断   |
| 回调          | 动态学习率衰减、早停            |

上述配置可在不暴露源码的情况下复现论文级实验流程，同时保持可读性。

---

## 5 结果与讨论

### 5.1 收敛性  
训练与验证损失在 50 轮内趋于稳定，未出现震荡或过拟合迹象。动态学习率在多次衰减后将学习率降至 1 × 10⁻⁴ 量级，帮助模型在局部最优附近精细调参。

### 5.2 预测性能  
- **均方误差（MSE）** 与 **平均绝对误差（MAE）** 双指标均低于基准持平模型，说明 LSTM 能准确捕捉污染浓度波动。  
- 可视化结果显示，模型输出与实测曲线在峰谷位置保持紧密贴合，尤其对高污染时段的峰值有良好响应。  
- 误差主要集中在极端快速变化时段，可能与气象剧变或不可观测因素（如临时排放峰值）相关。

![image-20250507175338636](https://raw.githubusercontent.com/Baymax12345678/img_repo/master/img/image-20250507175338636.png)

### 5.3 模型局限与改进方向  
1. **特征深度不足**：当前仅使用八个基础变量，可进一步加入边界层高度、交通流量等外部因素。  
2. **双层架构**：增加堆叠 LSTM 或引入双向 LSTM、注意力机制，有望提升捕捉长期/短期依赖的多尺度能力。  
3. **误差分布不均**：对极端污染事件可采用分位数损失或混合密度网络，更好地塑造尾部分布。

---

## 6 结论
本文系统阐述了多变量 LSTM 在空气污染预测任务中的原理与实践。实验结果验证了门控机制在复杂时序建模方面的有效性，并通过动态学习率与早停策略提高了模型泛化能力。未来工作可围绕多源数据融合、深度网络拓展及不确定性量化开展，以进一步提升预报精度与可信度。

---

## 参考文献
1. Kaggle — Beijing PM2.5 Data Set, 2017.  
2. Hochreiter, S. & Schmidhuber, J. “Long Short‑Term Memory”, *Neural Computation*, 1997.  